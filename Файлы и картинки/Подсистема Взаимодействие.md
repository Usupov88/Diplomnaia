
### Взаимодействие

Все добавляемые объекты включаем в новую подсистему **Взаимодействие**, выведенную в командный интерфейс.

1. Добавить определяемый тип **ПредметПроцесса**, включив в него все документы и справочники.
   
![предмет](%D0%BF%D1%80%D0%B5%D0%B4%D0%BC%D0%B5%D1%82.png)

1. Добавить справочник **Роли**:
  * без кода, с наименованием разумной длины.
  
![Роли](%D0%A0%D0%BE%D0%BB%D0%B8.png)  

1. Добавить регистр сведений **ИсполнителиРолей**:
  * с измерениями **Роль** (СправочникСсылка.Роли) и **Исполнитель** (СправочникСсылка.Сотрудники);
  * запретить незаполненные значения измерений.
  
 ![Исполнители роли](%D0%98%D1%81%D0%BF%D0%BE%D0%BB%D0%BD%D0%B8%D1%82%D0%B5%D0%BB%D0%B8%20%D1%80%D0%BE%D0%BB%D0%B8.png)

1. Добавить задачу **Задача**:
  * с адресацией по регистру **ИсполнителиРолей**;
  * с реквизитами адресации **Исполнитель** (СправочникСсылка.Сотрудники) и **Роль** (СправочникСсылка.Роли), связав их с одноименнными измерениями регистра **ИсполнителиРолей**;
  * с основным реквизитом адресации **Исполнитель**;
  * текущий исполнитель определяется по значению параметра сеанса **ТекущийСотрудник**;
  
  ![Задача](%D0%97%D0%B0%D0%B4%D0%B0%D1%87%D0%B0.png)

1. Добавить процесс **Поручение**:
  * с задачей **Задача**;
  * с реквизитами:
    * **НаименованиеЗадачи** (обязательный; строка такой же длины, как наименование задачи);
    * **ПодробноеОписание** (строка неограниченной длины);
    * **Исполнитель** (обязательный; составной тип: СправочникСсылка.Сотрудники, СправочникСсылка.Роли);
    * **Предмет** (ОпределяемыйТип.ПредметПроцесса);
  
  ![Поручение](%D0%9F%D0%BE%D1%80%D1%83%D1%87%D0%B5%D0%BD%D0%B8%D0%B5.png)

  * со схемой, состоящей из точки старта, точки действия и точки завершения;
  ![Процесс](%D0%9F%D1%80%D0%BE%D1%86%D0%B5%D1%81%D1%81.png)

  * в точке действия переопределить обработчик **ПриСозданииЗадач**, дозаполнив созданные задачи реквизитами процесса:
  
  Процедура ИсполнитьПоручениеПриСозданииЗадач(ТочкаМаршрутаБизнесПроцесса, ФормируемыеЗадачи, Отказ)
		
	Для Каждого ФормируемаяЗадача Из ФормируемыеЗадачи Цикл
		ФормируемаяЗадача.Наименование = НаименованиеЗадачи;
		ФормируемаяЗадача.ПодробноеОписание = ПодробноеОписание;
		ФормируемаяЗадача.Исполнитель = ?(ТипЗнч(Исполнитель) = Тип("СправочникСсылка.Сотрудники"),
		Исполнитель, Неопределено);
		ФормируемаяЗадача.Роль = ?(ТипЗнч(Исполнитель) = Тип("СправочникСсылка.Роли"),
		Исполнитель, Неопределено);
	КонецЦикла;
	
КонецПроцедуры

  * создать разумную форму процесса, содержащую только прикладные реквизиты, с возможностью заполнить их и стартовать процесс.
  
  ![Форма](%D0%A4%D0%BE%D1%80%D0%BC%D0%B0.png)

1. Добавить форму списка задач **ЗадачиМне**:
  * не назначать её основной формой (основная форма будет содержать все задачи);
  * добавить команду **ПринятьКИсполнению**, при вызове которой на севере нужно:
    * получить объект текущей задачи;
    * установить реквизит **Исполнитель** равным значению параметра сеанса **ТекущийСотрудник**;
    * записать объект текущей задачи;
  * добавить в нее динамический список по виртуальной таблице **Задача.Задача.ЗадачиПоИсполнителю** с разумным минимумом реквизитов;
  * добавить этот список в рабочую область начальной страницы;
  * удостовериться, что пользователи видят на рабочем столе свои задачи, адресованные им как непосредственно, так и посредством ролей.
  
  ![Задачи мне](%D0%97%D0%B0%D0%B4%D0%B0%D1%87%D0%B8%20%D0%BC%D0%BD%D0%B5.png)

  ![Результат](%D0%A0%D0%B5%D0%B7%D1%83%D0%BB%D1%8C%D1%82%D0%B0%D1%82.png)
  